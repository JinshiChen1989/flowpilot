---
name: IMU Sensor Threading Migration
status: open
created: 2025-08-29T18:59:14Z
updated: 2025-08-29T19:17:38Z
last_sync: 2025-08-29T19:17:38Z
github: https://github.com/JinshiChen1989/nagasware/issues/6
depends_on: [001]
parallel: false
conflicts_with: [004]
---

# Task: IMU Sensor Threading Migration

## Description
Migrate ICM-42688 IMU sensor to use new I2C threading pattern and autoware-aligned topic publishing. This implements the proven DFRobot ICM42688 pattern from submodules with ROS2 integration.

## Acceptance Criteria
- [ ] Refactor existing IMU driver to use I2CSensorBase threading pattern
- [ ] Implement producer-consumer threads (hardware capture separate from ROS publishing)
- [ ] Publish to autoware-aligned `/sensing/imu/data` topic with sensor_msgs/Imu
- [ ] Maintain 50Hz publishing rate with decoupled hardware timing
- [ ] Add temperature publishing to `/sensing/imu/temperature`

## Technical Details
Based on DFRobot_ICM42688 example from submodules:
```python
class ICM42688Node(I2CSensorBase):
    def __init__(self):
        super().__init__(bus_number=1, address=0x68, node_name='imu_sensor')
        
        # ROS2 publishers (autoware-aligned)
        self.imu_pub = self.create_publisher(Imu, '/sensing/imu/data', 10)
        self.temp_pub = self.create_publisher(Temperature, '/sensing/imu/temperature', 1)
        
    def _capture_loop(self):
        # Background hardware capture (50Hz hardware rate)
        while rclpy.ok():
            with self.i2c_lock:
                accel_data = self.read_accel()  # ICM42688 registers
                gyro_data = self.read_gyro()
            # Queue for ROS publishing thread
```

## Dependencies
- [ ] Task 001: I2C threading pattern implemented
- [ ] ICM-42688 hardware connected to I2C1 bus

## Effort Estimate
- Size: M
- Hours: 16
- Parallel: false (depends on I2C pattern)

## Definition of Done
- [ ] IMU sensor using I2C threading pattern successfully
- [ ] Publishing to autoware-aligned topics with standard sensor_msgs
- [ ] 50Hz data rate maintained with stable timing
- [ ] Hardware tested with real ICM-42688 on RK3588
- [ ] Temperature monitoring working